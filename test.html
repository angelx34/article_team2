<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  body {
    font-family: Arial, sans-serif;
    overflow-x: hidden;
  }
  
  /* Debug console for mobile testing */
  .debug {
    position: fixed;
    bottom: 10px;
    left: 10px;
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 10px;
    font-size: 12px;
    border-radius: 5px;
    z-index: 2000;
    max-width: 300px;
    font-family: monospace;
  }
  
  .navbar {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    background-color: #333;
    height: 60px;
    z-index: 1000;
    
    /* Start completely hidden */
    opacity: 0;
    visibility: hidden;
    transform: translateY(-100%);
    
    /* Multiple transition properties for better compatibility */
    transition: all 0.4s ease;
    -webkit-transition: all 0.4s ease;
    -moz-transition: all 0.4s ease;
    -o-transition: all 0.4s ease;
    
    /* Force hardware acceleration */
    -webkit-transform: translateY(-100%);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }
  
  .navbar.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
    -webkit-transform: translateY(0);
  }
  
  .navbar a {
    display: inline-block;
    color: white;
    text-decoration: none;
    padding: 20px 16px;
    font-size: 16px;
    line-height: 20px;
  }
  
  .navbar a:hover {
    background-color: rgba(255,255,255,0.1);
  }
  
  .hero {
    height: 100vh;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    text-align: center;
    padding: 20px;
  }
  
  .content {
    height: 2000px;
    padding: 20px;
    background: linear-gradient(180deg, #f0f0f0 0%, #e0e0e0 100%);
  }
  
  .section {
    padding: 50px 20px;
    margin: 50px 0;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
</style>
</head>
<body>

<div class="hero">
  <h1>Mobile Navbar Test</h1>
  <p>Scroll down to test the navbar transition</p>
</div>

<nav class="navbar" id="navbar">
  <a href="#home">Home</a>
  <a href="#about">About</a>
  <a href="#services">Services</a>
  <a href="#contact">Contact</a>
</nav>

<div class="content">
  <div class="section">
    <h2>Section 1</h2>
    <p>Keep scrolling to test the navbar. Check the debug info in the bottom left corner.</p>
  </div>
  
  <div class="section">
    <h2>Section 2</h2>
    <p>The navbar should appear when you scroll down past 150px.</p>
  </div>
  
  <div class="section">
    <h2>Section 3</h2>
    <p>More content to enable scrolling...</p>
  </div>
</div>

<!-- Debug console -->
<div class="debug" id="debug">
  Debug info will appear here...
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var navbar = document.getElementById("navbar");
  var debug = document.getElementById("debug");
  var scrollCount = 0;
  
  function updateDebug(message) {
    if (debug) {
      debug.innerHTML = message;
    }
  }
  
  // Initial debug
  updateDebug("DOM loaded. Navbar found: " + (navbar ? "YES" : "NO"));
  
  if (navbar) {
    // Test if we can add/remove classes manually first
    setTimeout(function() {
      updateDebug("Testing manual class toggle...");
      navbar.classList.add("show");
      
      setTimeout(function() {
        navbar.classList.remove("show");
        updateDebug("Manual toggle test complete. Setting up scroll listener...");
      }, 2000);
    }, 1000);
    
    // Mobile-fixed scroll handler
    function handleScroll() {
      scrollCount++;
      
      // Try multiple methods to get scroll position (mobile fix)
      var scrollTop = Math.max(
        window.pageYOffset || 0,
        document.documentElement.scrollTop || 0,
        document.body.scrollTop || 0,
        window.scrollY || 0
      );
      
      // Alternative method for stubborn mobile browsers
      if (scrollTop === 0) {
        var rect = document.body.getBoundingClientRect();
        scrollTop = Math.abs(rect.top);
      }
      
      var message = "Scroll #" + scrollCount + "<br>";
      message += "ScrollTop: " + Math.round(scrollTop) + "px<br>";
      message += "Threshold: 150px<br>";
      message += "Method: " + (scrollTop > 0 ? "SUCCESS" : "FAILED") + "<br>";
      
      if (scrollTop > 150) {
        navbar.classList.add("show");
        message += "Status: SHOWING navbar<br>";
        message += "HasClass: " + navbar.classList.contains("show");
      } else {
        navbar.classList.remove("show");
        message += "Status: HIDING navbar<br>";
        message += "HasClass: " + navbar.classList.contains("show");
      }
      
      updateDebug(message);
    }
    
    // Multiple event listeners for better compatibility
    window.addEventListener('scroll', handleScroll, false);
    document.addEventListener('scroll', handleScroll, false);
    
    // Also try with passive listeners
    if (window.addEventListener) {
      try {
        window.addEventListener('scroll', handleScroll, { passive: true });
      } catch(e) {
        // Passive not supported, already added regular listener above
      }
    }
    
    // Touch events for mobile
    document.addEventListener('touchmove', function() {
      setTimeout(handleScroll, 50);
    }, false);
    
    // Force a scroll check after a delay
    setTimeout(function() {
      updateDebug("Forcing initial scroll check...");
      handleScroll();
    }, 3000);
  }
});

// Additional mobile debugging
window.addEventListener('load', function() {
  console.log("Window loaded");
  console.log("User agent:", navigator.userAgent);
  console.log("Screen size:", window.innerWidth + "x" + window.innerHeight);
});
</script>

</body>
</html>